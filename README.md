# ุงููุฎุชุจุฑ ุงูููุฒูุงุฆู ุงูุชูุงุนูู (M5StickC PLUS2)

ููุธููุฉ ุชุนููููุฉ ุนูููุฉ ุชุนุชูุฏ ุนูู ููุญุฉ **M5StickC PLUS2** (ESP32) ูุชูููุฐ ูุดุฑุญ ุฃุฑุจุน ุชุฌุงุฑุจ ููุฒูุงุฆูุฉ ุฃุณุงุณูุฉ + ูุญุงูุงุฉ ูุธุฑูุฉ ุนุจุฑ ูุงุฌูุฉ ููุจ ูุญููุฉ:

1. ุชุฌุฑุจุฉ ุงูููุฐููุงุช
2. ุชุฌุฑุจุฉ ุงูุจูุฏูู ุงูุจุณูุท
3. ุชุฌุฑุจุฉ ุงูุณููุท ุงูุญุฑ
4. ุชุฌุฑุจุฉ ุงูุงุญุชูุงู ุนูู ุณุทุญ ูุงุฆู
5. ุฅุถุงูุฉ: ุฃุฑุจุน ุตูุญุงุช ูุญุงูุงุฉ (Projectile / Pendulum / Freefall / Friction)

> ูู ุฐูู ูุน ูุธุงู ุตูุชู ุชูุงุนูู ุบูุฑ ุญุงุฌุฒ (NonโBlocking EventโDriven Audio) ูููุงุชุฑ Kalman ูุชูุนูู ุจูุงูุงุช ุงููุณุชุดุนุฑ.

---
## โ ุงููุฒุงูุง ุงูุฑุฆูุณูุฉ
- ุชุดุบูู ุฐุงุชู ููุงุฌูุฉ ููุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ (ุงุชุตุงู ูุจุงุดุฑ ุนุจุฑ ุงูุดุจูุฉ).  
- ูุธุงู ุฃุญุฏุงุซ ุตูุชู ุงุญุชุฑุงูู ูุนุชูุฏ ุชุณูุณูุงุช ูุบูุงุช ูุตูุฑุฉ ููู ุญุงูุฉ (ุจุฏุกุ ููุงุณุ ุฐุฑูุฉุ ุณููุทุ ุงูุฒูุงูุ ุฅูุฌุงุฒ).  
- ูุตู ููุทูู ููุธู: `main.cpp` ููุฅุฏุงุฑุฉุ ู `experiments.*` ููููุทูุ ู `sound.*` ููุตูุชุ ู `filters.hpp` ููููุชุฑ.  
- ุฏุนู ุฅุนุงุฏุฉ ุงููุนุงูุฑุฉ ุจุถุบุทุฉ ุฒุฑ (ุฒุฑ B ูุน ุงูุถุบุท ุงููุทููู).  
- ูุถุน ุทุงูุฉ ููุฎูุถุฉ ุชููุงุฆู ุจุนุฏ ุฎููู (Sleep + ุฅุนุงุฏุฉ ุชุดุบูู).  
- ูุญุงูุงุฉ ูุธุฑูุฉ ุฏุงุฎู ุงููุชุตูุญ ูุดุฑุญ ุงูุนูุงูุงุช ุงูุฑูุงุถูุฉ.  

---
## ๐งช ูุตู ุงูุชุฌุงุฑุจ
### 1. ุชุฌุฑุจุฉ ุงูููุฐููุงุช
ุชููุณ ุงูุณุฑุนุฉ ุงูุงุจุชุฏุงุฆูุฉ ููุฃุฏุงุฉ ุนูุฏ ูุฐููุง ูุชุญุณุจ: ุฒูู ุงูุชุญูููุ ุฃูุตู ุงุฑุชูุงุนุ ุงููุฏู ุงูุฃููู.
- ุจุฏุก ุงูุชุฌุฑุจุฉ ูู ุตูุญุฉ ุงูููุจ (ุฅุฏุฎุงู ุงููุชูุฉ ูุฒุงููุฉ ุงููุฐู).
- ุฑุตุฏ ุงููุฐู (ุชุณุงุฑุน ุฒุงุฆุฏ)ุ ุซู ุงูุฏุฎูู ูู ูุฑุญูุฉ ุงูุณููุท ุงูุญุฑุ ุซู ุงููุจูุท.
- ูุนุชูุฏ ุนูู ุงูุชุบูุฑ ูู ุงูุชุณุงุฑุน ุงููุญูุฑู ุจุนุฏ ุทุฑุญ ุงููุฑูุจุฉ ุงูุซุงุจุชุฉ ููุฌุงุฐุจูุฉ.

### 2. ุชุฌุฑุจุฉ ุงูุจูุฏูู ุงูุจุณูุท
ุชุญุณุจ ุงูุฒูู ุงูุฏูุฑู ูุงูุชุฑุฏุฏ ููููุฉ ุงูุฌุงุฐุจูุฉ ุงููุญููุฉ (g) ุงุณุชูุงุฏุงู ุฅูู ููุงุณ ุนุฏุฉ ุงูุชุฒุงุฒุงุช.
- ููุทูุจ ุทูู ุงูุฎูุท ูุนุฏุฏ ุงูุงูุชุฒุงุฒุงุช ุงููุฑุงุฏ ููุงุณูุง.
- ููุดู ุงูุฐุฑูุฉ (Peaks) ุนุจุฑ ุชุญููู ุชุบููุฑ ุงูุฅุดุงุฑุฉ ุงููุนุงูุฌุฉ Kalman + ูุฑุดุญ ุงูุณูุงุจู.

### 3. ุชุฌุฑุจุฉ ุงูุณููุท ุงูุญุฑ
ุชุญุณุจ ุฒูู ุงูุณููุท ููููุฉ g ูู ูุณุงูุฉ ุณููุท ูุนูููุฉ.
- ูุจุฏุฃ ุงูุญุณุงุจ ุนูุฏ ุฏุฎูู ุงูุชุณุงุฑุน ุงูููู ููุทูุฉ ุดุจู ุงูุนุฏุงู ุงููุฒู.
- ูุชููู ุนูุฏ ุฑุตุฏ ุตุฏูุฉ ุงุตุทุฏุงู (ุชุณุงุฑุน ูุจูุฑ ููุงุฌุฆ).

### 4. ุชุฌุฑุจุฉ ุงูุงุญุชูุงู
ุชุญุณุจ ูุนุงูู ุงูุงุญุชูุงู ุงูุณุงูู ฮผ ูู ุงูุฒุงููุฉ ุงูุญุฑุฌุฉ ููุงูุฒูุงู: ฮผ โ tan(ฮธ).
- ูููู ุงููุณุชุฎุฏู ุงูุณุทุญ ุจุจุทุก ุญุชู ูุจุฏุฃ ุงูุงูุฒูุงู.
- ูุณุฌู ุงููุธุงู ุงูุฒุงููุฉ ูุญุธุฉ ุงูุงูููุงุช ุซู ูุญุณุจ ฮผ.

### 5. ุตูุญุงุช ุงููุญุงูุงุฉ (ูุญุงูุงุฉ ุฑูุงุถูุฉ)
ูุง ุชุนุชูุฏ ุนูู ุงูุญุณุงุณุ ุจู ุชุนุทู ุชุตูุฑุงู ูุธุฑูุงู ููุฑููุง:
- ููุฐููุงุช: ุญุณุงุจ ุงููุฏูุ ุงูุฒููุ ุงูุงุฑุชูุงุน.
- ุจูุฏูู: ุญุณุงุจ ุงูุฒูู ุงูุฏูุฑู ูู L ู g.
- ุณููุท ุญุฑ: ุญุณุงุจ ุฒูู ุงูุณููุท ูู ุงููุณุงูุฉ.
- ุงุญุชูุงู: ููุงุฑูุฉ ููุฉ ุงูุฌุงุฐุจูุฉ ุงูููุงุฒูุฉ ูููุฉ ุงูุงุญุชูุงู ุงููุตูู.

---
## ๐ต ูุธุงู ุงูุตูุช (EventโDriven Audio)
ุชู ุงุณุชุจุฏุงู ุงููุบูุงุช ุงูุญุงุฌุฒุฉ ุงูุณุงุจูุฉ ุจูุธุงู ุชุณูุณูุงุช (Sequences) ุบูุฑ ุญุงุฌุฒ:
- ูู ุญุฏุซ (Event) ูุซู: `Startup`, `CalibrateStart`, `PendulumPeak`, `ExperimentDone` ูู ุชุณูุณู ูุบูุงุช ุฎุงุต.
- ูุชู ุชุดุบูู ุงููุบูุงุช ุจุงูุชุชุงุจุน ุฏุงุฎู `Sound::update()` ุฏูู ุชุนุทูู ุงูุญููุฉ ุงูุฑุฆูุณูุฉ.
- ุฅุถุงูุฉ ุฃุญุฏุงุซ ุฌุฏูุฏุฉ ุชุชู ุนุจุฑ ุชุนุฏูู enum ูู `sound.hpp` ูุฑุจุทูุง ุจุชุณูุณู ูู `sound.cpp`.

ูุซุงู ุฅุถุงูุฉ ุญุฏุซ:
1. ุฅุถุงูุฉ ุงุณู ุงูุญุฏุซ ูู `enum class Event`.
2. ุฅูุดุงุก ูุตูููุฉ `SeqStep` ุฌุฏูุฏุฉ.
3. ุชุญุฏูุซ ุฏุงูุฉ `mapEvent()` ูุฑุจุท ุงูุญุฏุซ ุจุงูุชุณูุณู.
4. ุงุณุชุฎุฏุงู `Sound::trigger(Event::NewEvent)` ูู ุงูููุทู.

---
## ๐ ุชุฏูู ุงูุชูููุฐ
1. ุชุดุบูู ูุชููุฆุฉ (ุนุฑุถ + ูุนุงูุฑุฉ IMU + ุชุดุบูู ุญุฏุซ Startup).
2. ูุญุงููุฉ ุงูุงุชุตุงู ุจุงูุดุจูุฉ ุงููุฎุฒูุฉุ ูุฅูุง ูุฏุฎู ูุถุน ุฅุนุฏุงุฏ WiFi (AP ุฐุงุชู: ุงุณู ุงูุดุจูุฉ `M5-Experiment-Setup`).
3. ุนูุฏ ุงูุงุชุตุงู: ุชุดุบูู ุฎุงุฏู ููุจ ูุญูู ูุนุฑุถ ููุญุฉ ุงูุชุญูู.
4. ุงููุณุชุฎุฏู ููุชุญ ุงููุชุตูุญ ุฅูู ุนููุงู ุงูู IP ุงูุธุงูุฑ ุนูู ุงูุดุงุดุฉ.
5. ุงุฎุชูุงุฑ ุชุฌุฑุจุฉ โ ุจุฏุก โ ุงูุฌูุงุฒ ูุฌูุน ุจูุงูุงุช โ ุงูุชูุงุก โ ุงููุชุงุฆุฌ ุชุธูุฑ ูู ุงูุตูุญุฉ.
6. ุฎููู ุทููู โ ูุถุน ุชูููุฑ ุงูุทุงูุฉ.

---
## โ๏ธ ุงููุชุทูุจุงุช
- ููุญุฉ: M5StickC PLUS2 (ESP32-PICO-V3-02).
- PlatformIO (ุจูุฆุฉ ุงูุชุทููุฑ) + ุฅุทุงุฑ Arduino.
- ุงูููุชุจุงุช (ุชูุฒู ุชููุงุฆูุงู): M5Unifiedุ ArduinoJsonุ WebServerุ DNSServerุ EEPROM.

---
## ๐งญ ุงููุนุงูุฑุฉ (Calibration)
ุชุชู ุชููุงุฆูุงู ุนูุฏ ุงูุชุดุบูู:
- ุงุฌุนู ุงูุฌูุงุฒ ุซุงุจุชูุง ุนูู ุณุทุญ ุฃููู ููุฏุฉ ุซุงููุชูู ุฃุซูุงุก ุนุจุงุฑุฉ "Calibrating...".
- ูููู ุฅุนุงุฏุฉ ุงููุนุงูุฑุฉ: ุงูุถุบุท ุงููุทูู ุนูู ุฒุฑ B (ุญูุงูู 3 ุซูุงูู).

ุงูููู ุงููุฎุฒูุฉ:
- ูุญูุฑ Z ููููุฐููุงุช.
- ูุญูุฑ Y ููุจูุฏูู.
- ูุญูุฑ X ููุงุญุชูุงู.

---
## ๐ก ุฅุนุฏุงุฏ WiFi
ุฅุฐุง ูู ูุฌุฏ ุจูุงูุงุช ูุญููุธุฉ:
1. ููุดุฆ ููุทุฉ ูุตูู: `M5-Experiment-Setup`.
2. ุงุชุตู ุจูุง ูู ุงููุงุชู / ุงูุญุงุณูุจ.
3. ุงูุชุญ ุงููุชุตูุญ: 192.168.4.1 (ุฃู ุฑุงุจุท ููุญูู ุชููุงุฆูุงู Captive Portal).
4. ุงุฎุชุฑ ุงูุดุจูุฉ ูุฃุฏุฎู ูููุฉ ุงููุฑูุฑ โ ุฅุนุงุฏุฉ ุชุดุบูู ุชููุงุฆู.

ุจูุงูุงุช ุงูุฏุฎูู ุชุญูุธ ูู EEPROM (ุจุณูุทุฉ ูุบูุฑ ูุดูุฑุฉ โ ููุงุณุชุฎุฏุงู ุงูุชุนูููู ููุท).

---
## ๐ฅ๏ธ ูุงุฌูุฉ ุงูููุจ
ุชุดูู:
- ุนููุฏ ููุชุฌุงุฑุจ ุงูุนูููุฉ.
- ุนููุฏ ูููุญุงูุงุฉ ุงููุธุฑูุฉ.
- ูุบูุงุช ุชูุงุนู ุจุณูุทุฉ ุนูุฏ ุชูุฑูุฑ ุงููุฃุฑุฉ (ุนูู ุงููุชุตูุญ ููุท ุนุจุฑ Tone.js).
- ูุงูุฐุฉ ูุณุงุนุฏุฉ (ูุนูููุงุช ุงูุชูุงุตู).

---
## ๐ ุณูุงูุฉ ูุชุฌููุฒุงุช
- ูููุถูู ุฅุฌุฑุงุก ุชุฌุงุฑุจ ุงูุณููุท ุงูุญุฑ ููู ุณุทุญ ุขูู (ุฅุณููุฌู ุฃู ูุงุนู).
- ุชุฌุงุฑุจ ุงูููุฐููุงุช: ุชุฌูุจ ุงููุฐู ุนูู ุงุฑุชูุงุนุงุช ูุฏ ุชูุชูู ุงูุฌูุงุฒ.
- ุงูุงุญุชูุงู: ุฅูุงูุฉ ุชุฏุฑูุฌูุฉ ูุชูุงุฏู ุงูุณููุท ุงูุนููู.

---
## ๐งช ููููุฉ ุงูุจูุงุก ูุงูุฑูุน (PlatformIO)
ุถูู VS Code:
1. ุงูุชุญ ุงููุดุฑูุน.
2. ูู ุงูุดุฑูุท ุงูุฌุงูุจู: PlatformIO โ Build.
3. ูุตู ุงูููุญุฉ ุนุจุฑ USB.
4. ุงุฎุชุฑ ุงููููุฐ ุฅุฐุง ุทููุจ.
5. ุงุถุบุท Upload.

ุฃู ุณุทุฑ ุฃูุงูุฑ:
```bash
pio run
pio run -t upload
```

---
## ๐๏ธ ุงููููู ุงูุจุฑูุฌู
```
src/
  main.cpp          โ ุงูุชููุฆุฉ + WiFi + REST + ุญููุฉ ุฑุฆูุณูุฉ
  experiments.hpp   โ ุชุนุฑูู ุงููุชุบูุฑุงุช ูุฃููุงุน ุงูุญุงูุฉ
  experiments.cpp   โ ููุทู ุงูุชุฌุงุฑุจ ุงูููุฒูุงุฆูุฉ + ูุดู ุงูุฃุญุฏุงุซ
  filters.hpp       โ ูุงุฆู KalmanFilter ุจุณูุท ููุชูุนูู
  sound.hpp/.cpp    โ ูุธุงู ุงูุตูุช ุงูุญุฏุซู (Sequences)
platformio.ini      โ ุฅุนุฏุงุฏุงุช ุจูุฆุฉ PlatformIO
```

---
## ๐๏ธ ุชูุณูุน ูุณุชูุจูู ููุชุฑุญ
- ุฅุถุงูุฉ ุชุณุฌูู CSV ููููุงุณุงุช ุนุจุฑ SPIFFS ุฃู ุจุทุงูุฉ ุฎุงุฑุฌูุฉ.
- ุจุซ WebSocket ุญู ููุจูุงูุงุช (ุฑุณู ููุญูู ุฒููู).
- ุฏุนู ุชุฌุฑุจุฉ ุงูุทุงูุฉ ุงูุญุฑููุฉ/ุงูุฅุฒุงุญุฉ (ุนุฑุจุฉ + ูุณุงุฑ).
- ุงุณุชุนูุงู ูุฑุดุญ ุชูููู (Complementary ุฃู Mahony) ูุชุญุณูู ุฒูุงูุง ุงูุงุญุชูุงู.

---
## โ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
| ุงูุนุฑุถ | ุงูุชูุณูุฑ | ุงูุฅุฌุฑุงุก |
|-------|---------|---------|
| ูุง ุนููุงู IP | ูุดู ุงุชุตุงู ุงูุดุจูุฉ | ุงุฏุฎู ูุถุน ุงูุฅุนุฏุงุฏ (ุฅุนุงุฏุฉ ุชุดุบูู ุจุฏูู WiFi ูุนุฑูู) |
| ูุชุงุฆุฌ ุตูุฑูุฉ | ูู ุชููุชูุท ุงูุฃุญุฏุงุซ | ุชุฃูุฏ ูู ุงูุญุฑูุฉ ุงูุตุญูุญุฉ ููู ุงูุชุนูููุงุช |
| ุงูุตูุช ุตุงูุช | ููุจุฑ ูุนุทู ุฃู ุญุฌู | ุชุฃูุฏ ูู `M5.Speaker.begin()` ููุทุน ุงูุทุงูุฉ |
| ุงูุฒูุงู ุงูุงุญุชูุงู ูุจูุฑ | ุณุทุญ ุบูุฑ ููุงุณุจ | ุฌุฑูุจ ุณุทุญูุง ุฃูุซุฑ ุฎุดููุฉ |

---
## ๐ค ุญููู ููุนูููุงุช
ยฉ ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ูุงูุชุนููู โ ุณูุทูุฉ ุนูุงู 2023  
ุงูุชุทููุฑ ุงูุจุฑูุฌู: ุฃุญูุฏ ุงููุตุงุจู  
ุงูุบุฑุถ: ุฏุนู ุงูุชุนููู ุงูุนููู ูู ุงููุฎุชุจุฑุงุช ุงููุฏุฑุณูุฉ.  

> ูุฐุง ุงููุดุฑูุน ูุฃุบุฑุงุถ ุชุนููููุฉุ ููููู ุชุญุณููู ุฃู ุชุนุฏููู ุฏุงุฎููุงู.

---
## ๐ฌ ุชูุงุตู
ููุฏุนู ูุงูุงุณุชูุณุงุฑ:  
ุงููุงุชู / ูุงุชุณุงุจ: +968 9984 8382  

---
### ููุงุญุธุงุช ุฎุชุงููุฉ
ุฅุฐุง ุฑุบุจุช ุจุฅุถุงูุฉ ูุบุฉ ุซุงููุฉ (ุฅูุฌููุฒู) ูููู ุฅูุดุงุก `README.en.md` ูุน ุชูุฎูุต ูุฎุชุตุฑุ ุฃู ุฌุนู ุงูุฃูุณุงู ุซูุงุฆูุฉ ุงููุบุฉ.

ุจุงูุชูููู ูู ุงูุชุฏุฑูุณ ูุงูุชุฌุงุฑุจ! ๐ฌ
